<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Civiliza√ß√£o Clim√°tica</title>
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/disasters.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&family=Roboto+Slab:wght@400;700;900&display=swap"
        rel="stylesheet">
</head>

<body>
    <div id="scanline"></div>
    <div id="score-popup" class="hidden"></div>
    <div id="app">
        <!-- ROLE SELECTION -->
        <div id="role-screen" class="screen active">
            <header class="hero-section">
                <h1 class="glitch" data-text="CLIMATE CIV">CIVILIZA√á√ÉO CLIM√ÅTICA</h1>
                <p class="tagline">O SIMULADOR DE GEST√ÉO CLIM√ÅTICA PARA L√çDERES DO FUTURO</p>
            </header>

            <div class="button-group">
                <button id="teacher-role-btn" class="retro-btn retro-btn-secondary">Professor</button>
                <button id="player-role-btn" class="retro-btn">Aluno</button>
            </div>

            <section class="tutorial-section">
                <h2>COMO JOGAR</h2>
                <div class="tutorial-steps">
                    <div class="tutorial-step" tabindex="0">
                        <div class="step-header">
                            <span class="step-number">01</span>
                            <h3>O DESAFIO</h3>
                        </div>
                        <p>Voc√™ √© o l√≠der de uma na√ß√£o no ano 2025. O clima est√° mudando e sua miss√£o √© garantir a
                            sobreviv√™ncia e o progresso da sua civiliza√ß√£o at√© o ano 2100.</p>
                        <!-- <img src="assets/tutorial/step1.png" alt="Tela de In√≠cio" class="tutorial-img"> -->
                    </div>

                    <div class="tutorial-step" tabindex="0">
                        <div class="step-header">
                            <span class="step-number">02</span>
                            <h3>ALOCA√á√ÉO DE RECURSOS</h3>
                        </div>
                        <p>A cada rodada, voc√™ recebe 100 cr√©ditos. Use os sliders para distribuir esse valor entre 5
                            iniciativas. Escolha bem onde investir mais!</p>
                        <!-- <img src="assets/tutorial/step2.png" alt="Sliders de Recursos" class="tutorial-img"> -->
                    </div>

                    <div class="tutorial-step" tabindex="0">
                        <div class="step-header">
                            <span class="step-number">03</span>
                            <h3>CONSEQU√äNCIAS</h3>
                        </div>
                        <p>Seus investimentos geram uma pontua√ß√£o. Pontua√ß√µes baixas podem levar a desastres e crises
                            crim√°ticas, enquanto pontua√ß√µes altas trazem estabilidade.</p>
                        <!-- <img src="assets/tutorial/step3.png" alt="Resultado da Rodada" class="tutorial-img"> -->
                    </div>

                    <div class="tutorial-step" tabindex="0">
                        <div class="step-header">
                            <span class="step-number">04</span>
                            <h3>O VEREDITO</h3>
                        </div>
                        <p>Ap√≥s 5 rodadas, veremos o legado da sua gest√£o. Sua civiliza√ß√£o alcan√ßar√° a Utopia Verde ou o
                            Colapso Total?</p>
                        <!-- <img src="assets/tutorial/step4.png" alt="Resultado Final" class="tutorial-img"> -->
                    </div>
                </div>
            </section>

            <footer class="main-footer">
                <p>&copy; 2026 Leles Tecnologia LTDA. Todos os direitos reservados.</p>
                <p>Licenciado para uso educacional.</p>
            </footer>
        </div>

        <!-- TEACHER LOGIN / SETUP -->
        <div id="teacher-setup-screen" class="screen hidden">
            <h1>CENTRO DE COMANDO</h1>
            <div id="session-info" class="hidden">
                <div class="command-center-header">
                    <p class="session-label">C√ìDIGO DA MISS√ÉO</p>
                    <h2 id="session-code-display" class="glitch mission-code">----</h2>
                    <p class="status-text">AGUARDANDO L√çDERES | <span id="player-count">0</span>/6 CONECTADOS</p>
                </div>

                <div class="teacher-lobby-grid" id="teacher-lobby-grid">
                    <!-- Player cards injected by JS -->
                </div>

                <div class="button-group">
                    <button id="cancel-session-btn" class="retro-btn retro-btn-secondary return-btn">CANCELAR</button>
                    <button id="start-game-btn" class="retro-btn" disabled>INICIAR MISS√ÉO</button>
                </div>
            </div>
            <div id="teacher-initial-actions" class="button-group">
                <button id="create-session-btn" class="retro-btn">CRIAR NOVA SESS√ÉO</button>
                <button id="back-to-role-btn" class="retro-btn retro-btn-secondary return-btn">VOLTAR</button>
                <div id="create-loading" class="loading-container hidden">
                    <div class="loading-bar"></div>
                    <p>Sincronizando com o sat√©lite...</p>
                </div>
            </div>
            <div class="reconnect-container">
                <div class="input-group">
                    <h2>J√Å TEM UMA SESS√ÉO?</h2>
                    <p>Insira o c√≥digo da sess√£o para reconectar.</p>
                    <input class="retro-input" type="text" id="reconnect-code-input" placeholder="C√ìDIGO 4 D√çGITOS"
                        maxlength="4">
                    <button id="reconnect-session-btn" class="retro-btn retro-btn-secondary">RECONECTAR</button>
                    <div id="reconnect-loading" class="loading-container hidden">
                        <div class="loading-bar"></div>
                        <p>Recuperando sinal da base...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- PLAYER JOIN -->
        <div id="player-join-screen" class="screen hidden">
            <h1>ENTRAR NA MISS√ÉO</h1>
            <div class="input-group">
                <input class="retro-input" type="text" id="join-code-input" placeholder="C√ìDIGO (4 D√çGITOS)"
                    maxlength="4">
                <input class="retro-input" type="text" id="player-name-input" placeholder="SEU NOME" maxlength="12">
            </div>
            <div class="button-group">
                <button id="back-to-role-btn" class="retro-btn retro-btn-secondary return-btn">VOLTAR</button>
                <button id="join-session-btn" class="retro-btn">CONECTAR</button>
            </div>
            <p id="join-status"></p>
        </div>

        <!-- PLAYER LOBBY -->
        <div id="player-lobby-screen" class="screen hidden">
            <h1>PREPARANDO MISS√ÉO</h1>
            <p>Voc√™ est√° conectado! Aguardando o professor iniciar a miss√£o.</p>

            <div class="lobby-container">
                <h2>L√çDERES CONECTADOS:</h2>
                <ul id="lobby-players-list" class="lobby-list">
                    <!-- Players injected by JS -->
                </ul>
            </div>

            <div class="button-group">
                <button id="leave-session-btn" class="retro-btn retro-btn-secondary">SAIR DA SESS√ÉO</button>
            </div>
        </div>

        <!-- MAIN GAME SCREEN (TEACHER VIEW) -->
        <div id="teacher-game-screen" class="screen hidden">
            <div id="hud">
                <div id="players-dashboard">
                    <!-- Player cards injected by JS -->
                </div>
                <div class="round-info">
                    <span id="round-display">ANO: 2025</span>
                    <div id="timer-display">90s</div>
                </div>
            </div>

            <div id="scenario-container">
                <h2 id="scenario-text">Carregando cen√°rio...</h2>
                <div id="submission-status">
                    <p>Aguardando decis√µes dos jogadores...</p>
                    <div id="player-status-grid"></div>
                </div>
            </div>
        </div>

        <!-- PLAYER INTERACTION SCREEN -->
        <div id="player-game-screen" class="screen hidden">
            <div class="player-hud">
                <span id="player-status-name">JOGADOR</span>
                <div id="player-timer-display">90s</div>
            </div>
            <div id="resource-allocation-container">
                <h3>ALOCA√á√ÉO DE RECURSOS</h3>
                <p id="player-scenario-brief"></p>
                <div id="resource-pool">RECURSOS DISPON√çVEIS: <span id="remaining-resources">100</span></div>

                <div id="sliders-container">
                    <!-- 5 Sliders injected by JS -->
                </div>


                <div class="presidential-btn-container">
                    <button id="submit-allocation-btn" class="big-red-btn">
                        <span class="btn-icon">‚óè</span>
                    </button>
                    <div class="btn-label">
                        <span>CONFIRMAR DECIS√ÉO <span class="key-hint">ESPA√áO</span></span>
                        
                    </div>
                </div>
            </div>
            <div id="wait-message" class="hidden">
                <h2 class="glitch">DECIS√ÉO ENVIADA</h2>
                <p>Aguardando outros jogadores e an√°lise do sistema...</p>
            </div>
        </div>

        <!-- ROUND RESULTS SCREEN (PLAYER) -->
        <div id="round-results-screen" class="screen hidden">
            <h1>RESULTADO DA RODADA <span id="results-round-number">1</span></h1>

            <div class="player-feedback">
                <div class="round-score-display">
                    <span class="score-label">PONTUA√á√ÉO TOTAL</span>
                    <span id="total-score" class="score-value">0</span>
                </div>

                <div id="performance-feedback" class="feedback-message">
                    <!-- Status injected by JS -->
                </div>

                <div id="initiative-breakdown" class="initiative-breakdown">
                    <!-- Initiative precision details injected by JS -->
                </div>

                <p class="waiting-text">Aguardando pr√≥xima rodada...</p>
            </div>
        </div>

        <!-- ROUND RESULTS SCREEN (TEACHER) -->
        <div id="teacher-results-screen" class="screen hidden">
            <h1>AN√ÅLISE DA RODADA <span id="teacher-results-round-number">1</span></h1>

            <div class="results-grid" id="results-player-grid">
                <!-- Player result cards injected by JS -->
            </div>

            <div class="button-group">
                <button id="next-round-btn" class="retro-btn">PR√ìXIMA RODADA</button>
            </div>
        </div>

        <!-- END SCREEN -->
        <div id="end-screen" class="screen hidden">
            <h1>MISSI√ÉO CONCLU√çDA</h1>

            <!-- Teacher specific end view -->
            <div id="teacher-end-view" class="hidden">
                <div id="analytics-container">
                    <h2>ESTADO DA CIVILIZA√á√ÉO</h2>
                    <div id="player-outcomes-grid">
                        <!-- Individual player cards with status injected by JS -->
                    </div>
                </div>
                <div id="restart-lobby">
                    <h3>PREPARA√á√ÉO PARA NOVA MISS√ÉO</h3>
                    <div id="player-ready-grid"></div>
                    <button id="teacher-restart-btn" class="retro-btn" disabled>REINICIAR SISTEMAS</button>
                </div>
            </div>

            <!-- Player specific end view -->
            <div id="player-end-view" class="hidden">
                <div id="personal-rundown">
                    <div id="player-score-banner"></div>
                    <div id="scenario-history">
                        <!-- History items injected by JS -->
                    </div>
                </div>
                <button id="player-ready-btn" class="retro-btn">QUERO JOGAR NOVAMENTE</button>
                <div id="player-ready-msg" class="hidden">
                    <p class="glitch">SINAL DE PRONTID√ÉO ENVIADO</p>
                    <p>Aguardando o professor e outros l√≠deres...</p>
                </div>
            </div>
        </div>

        <!-- Mute Button -->
        <div id="audio-controls" style="position: fixed; top: 10px; right: 10px; z-index: 1000;">
            <button id="mute-btn" class="retro-btn icon-btn">üîä</button>
        </div>
    </div>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>

    <script src="scripts/data.js"></script>
    <script src="scripts/firebase-config.js"></script>
    <script src="scripts/api.js"></script>
    <script src="scripts/AudioController.js"></script>
    <script src="scripts/game.js"></script>
</body>

</html>